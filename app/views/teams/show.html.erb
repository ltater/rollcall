<h1><%= @team.name %></h1>

<h2>Players (<%= @team.players.count %>)</h2>
<% if @team.players.any? %>
	<ul>
		<% @team.players.each do |player| %>
			<li>
				<%= player.name %>
				<%= button_to "Remove", remove_player_team_path(@team, player_id: player.id),
					method: :post,
					data: { confirm: "Remove #{player.name} from team?" },
					style: "display: inline; margin-left: 10px;" %>
			</li>
		<% end %>
	</ul>
<% else %>
	<p>No players on this team yet.</p>
<% end %>

<h2>Add Players to Team</h2>
<% available_players = Player.where(team_id: nil) %>
<% if available_players.any? %>
	<%= form_with url: add_player_team_path(@team), method: :post do |f| %>
		<%= f.collection_select :player_id, available_players, :id, :name, { prompt: "Select a Player" } %>
		<%= f.submit "Add to Team" %>
	<% end %>

<!-- Add back in Ruby squids if deciding to use this again. Else, remove.
	<ul>
		 < available_players.each do |player| %>
			<li>
				<= player.name %>
				<= button_to "Add to Team", add_player_team_path(@team, player_id: player.id),
					method: :post,
					style: "display: inline; margin-left: 10px;" %>
			</li>
		< end %>
	</ul>
-->

<% else %>
	<p>No available players to add. All players are assigned to teams.</p>
<% end %>

<h2>Games</h2>

<%= link_to "Add New Game", new_team_game_path(@team), style: "display: inline-block; padding: 10px 20px; background: #4CAF50; color: white; text-decoration: none; border-radius: 5px; margin-bottom: 20px;" %>

<h3>Upcoming Games</h3>
<% if @team.upcoming_games.any? %>
  <table style="width: 100%; border-collapse: collapse;">
    <thead>
      <tr style="background: #f0f0f0;">
        <th style="padding: 10px; text-align: left;">Date</th>
        <th style="padding: 10px; text-align: left;">Time</th>
        <th style="padding: 10px; text-align: left;">Opponent</th>
        <th style="padding: 10px; text-align: left;">Location</th>
        <th style="padding: 10px; text-align: left;">Home/Away</th>
        <th style="padding: 10px; text-align: left;">Roll Call</th>
        <th style="padding: 10px; text-align: left;">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @team.upcoming_games.each do |game| %>
        <tr style="border-bottom: 1px solid #ddd;">
        	<td style="padding: 10px;"><%= game.date.strftime("%b %d, %Y") %></td>
        	<td style="padding: 10px;"><%= game.time.strftime("%I:%M %p") %></td>
          	<td style="padding: 10px;"><%= game.opponent %></td>
          	<td style="padding: 10px;"><%= game.location %></td>
          	<td style="padding: 10px;">
            	<%= game.home_away == 'home' ? 'üè† Home' : '‚úàÔ∏è Away' %>
          	</td>
          	<td style="padding: 10px;">
            	<% if game.rsvps.any? %>
              		‚úÖ <%= game.rsvps.yes.count %>
              		/ ‚ùå <%= game.rsvps.no.count %>
              		/ ‚è≥ <%= game.rsvps.pending.count %>
            	<% else %>
              		<em>Not sent</em>
            	<% end %>
          	</td>
          	<td style="padding: 10px;">
            	<%= link_to "View", team_game_path(@team, game), style: "margin-right: 10px;" %>
            	<%= link_to "Edit", edit_team_game_path(@team, game), style: "margin-right: 10px;" %>
            	<%= button_to "Delete", team_game_path(@team, game), 
                	method: :delete, 
                	data: { confirm: "Delete this game?" },
                	style: "display: inline; padding: 5px 10px; background: #f44336; color: white; border: none; border-radius: 3px;" %>
          	</td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>No upcoming games scheduled.</p>
<% end %>

<h3>Past Games</h3>
<% if @team.past_games.any? %>
	<ul>
		<% @team.past_games.limit(5).each do |game| %>
			<li>
				<%= game.date.strftime("%b %d, %Y") %>
				vs <%= game.opponent %>
				(<%= game.home_away == 'home' ? 'Home' : 'Away' %>) - 
				<%= game.location %>
				<%= link_to "View", team_game_path(@team, game) %>
			</li>
		<% end %>
	</ul>
<% else %>
	<p>No past games.</p>
<% end %>

<%= link_to "Back to Teams", teams_path %>
<%= link_to "Edit Team", edit_team_path(@team) %>
<%= button_to "Delete Team", @team, method: :delete, data: { turbo_confirm: "Are you sure?" } %>